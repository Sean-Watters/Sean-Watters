<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Free.IdempotentCommutativeMonoid.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="29" class="Keyword">open</a> <a id="34" class="Keyword">import</a> <a id="41" href="Data.FreshList.InductiveInductive.html" class="Module">Data.FreshList.InductiveInductive</a>
<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Data.List.html" class="Module">Data.List</a> <a id="97" class="Keyword">using</a> <a id="103" class="Symbol">(</a><a id="104" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="108" class="Symbol">;</a> <a id="110" href="Data.List.Base.html#7375" class="InductiveConstructor">[]</a><a id="112" class="Symbol">;</a> <a id="114" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="117" class="Symbol">)</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="140" class="Keyword">renaming</a> <a id="149" class="Symbol">(</a><a id="150" href="Data.Nat.Base.html#1654" class="Function Operator">_&lt;_</a> <a id="154" class="Symbol">to</a> <a id="157" class="Function Operator">_&lt;ℕ_</a><a id="161" class="Symbol">)</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="195" class="Keyword">renaming</a> <a id="204" class="Symbol">(</a><a id="205" href="Data.Nat.Properties.html#9786" class="Function">&lt;-trans</a> <a id="213" class="Symbol">to</a> <a id="216" class="Function">&lt;ℕ-trans</a><a id="224" class="Symbol">)</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>
<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="278" class="Keyword">open</a> <a id="283" class="Keyword">import</a> <a id="290" href="Function.html" class="Module">Function</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>
<a id="367" class="Keyword">open</a> <a id="372" class="Keyword">import</a> <a id="379" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="Induction.WellFounded.html" class="Module">Induction.WellFounded</a>

<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Algebra.Structure.OICM.html" class="Module">Algebra.Structure.OICM</a>

<a id="488" class="Keyword">module</a> <a id="495" href="Free.IdempotentCommutativeMonoid.Base.html" class="Module">Free.IdempotentCommutativeMonoid.Base</a>
  <a id="535" class="Symbol">{</a><a id="536" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="538" class="Symbol">:</a> <a id="540" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="543" class="Symbol">}</a> <a id="545" class="Symbol">{</a><a id="546" href="Free.IdempotentCommutativeMonoid.Base.html#546" class="Bound Operator">_≈_</a> <a id="550" class="Symbol">:</a> <a id="552" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="554" class="Symbol">→</a> <a id="556" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="558" class="Symbol">→</a> <a id="560" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="563" class="Symbol">}</a> <a id="565" class="Symbol">{</a><a id="566" href="Free.IdempotentCommutativeMonoid.Base.html#566" class="Bound Operator">_&lt;_</a> <a id="570" class="Symbol">:</a> <a id="572" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="574" class="Symbol">→</a> <a id="576" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="578" class="Symbol">→</a> <a id="580" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="583" class="Symbol">}</a>
  <a id="587" class="Symbol">(</a><a id="588" href="Free.IdempotentCommutativeMonoid.Base.html#588" class="Bound">&lt;-STO</a> <a id="594" class="Symbol">:</a> <a id="596" href="Algebra.Structure.OICM.html#320" class="Record">IsPropStrictTotalOrder</a> <a id="619" href="Free.IdempotentCommutativeMonoid.Base.html#546" class="Bound Operator">_≈_</a> <a id="623" href="Free.IdempotentCommutativeMonoid.Base.html#566" class="Bound Operator">_&lt;_</a><a id="626" class="Symbol">)</a>
  <a id="630" class="Keyword">where</a>

<a id="637" class="Keyword">private</a>
  <a id="≈-Eq"></a><a id="647" href="Free.IdempotentCommutativeMonoid.Base.html#647" class="Function">≈-Eq</a> <a id="652" class="Symbol">=</a> <a id="654" href="Relation.Binary.Structures.html#6503" class="Function">IsPropStrictTotalOrder.isEquivalence</a> <a id="691" href="Free.IdempotentCommutativeMonoid.Base.html#588" class="Bound">&lt;-STO</a>
  <a id="≈-sym"></a><a id="699" href="Free.IdempotentCommutativeMonoid.Base.html#699" class="Function">≈-sym</a> <a id="705" class="Symbol">=</a> <a id="707" href="Relation.Binary.Structures.html#1622" class="Field">IsEquivalence.sym</a> <a id="725" href="Free.IdempotentCommutativeMonoid.Base.html#647" class="Function">≈-Eq</a>
  <a id="&lt;-tri"></a><a id="732" href="Free.IdempotentCommutativeMonoid.Base.html#732" class="Function">&lt;-tri</a> <a id="738" class="Symbol">=</a> <a id="740" href="Relation.Binary.Structures.html#6572" class="Function">IsPropStrictTotalOrder.compare</a> <a id="771" href="Free.IdempotentCommutativeMonoid.Base.html#588" class="Bound">&lt;-STO</a>
  <a id="&lt;-trans"></a><a id="779" href="Free.IdempotentCommutativeMonoid.Base.html#779" class="Function">&lt;-trans</a> <a id="787" class="Symbol">=</a> <a id="789" href="Relation.Binary.Structures.html#6537" class="Function">IsPropStrictTotalOrder.trans</a> <a id="818" href="Free.IdempotentCommutativeMonoid.Base.html#588" class="Bound">&lt;-STO</a>
  <a id="&lt;-resp-≈"></a><a id="826" href="Free.IdempotentCommutativeMonoid.Base.html#826" class="Function">&lt;-resp-≈</a> <a id="835" class="Symbol">=</a> <a id="837" href="Relation.Binary.Structures.html#4162" class="Function">IsPropStrictTotalOrder.&lt;-resp-≈</a> <a id="869" href="Free.IdempotentCommutativeMonoid.Base.html#588" class="Bound">&lt;-STO</a>
  <a id="_≈?_"></a><a id="877" href="Free.IdempotentCommutativeMonoid.Base.html#877" class="Function Operator">_≈?_</a> <a id="882" class="Symbol">=</a> <a id="884" href="Relation.Binary.Structures.html#6632" class="Function Operator">IsPropStrictTotalOrder._≟_</a> <a id="911" href="Free.IdempotentCommutativeMonoid.Base.html#588" class="Bound">&lt;-STO</a>
  <a id="919" class="Keyword">open</a> <a id="924" href="Data.FreshList.InductiveInductive.html#9793" class="Module">WithEq</a> <a id="931" href="Free.IdempotentCommutativeMonoid.Base.html#566" class="Bound Operator">_&lt;_</a> <a id="935" href="Free.IdempotentCommutativeMonoid.Base.html#647" class="Function">≈-Eq</a> <a id="940" href="Free.IdempotentCommutativeMonoid.Base.html#826" class="Function">&lt;-resp-≈</a>

<a id="SortedList"></a><a id="950" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="961" class="Symbol">:</a> <a id="963" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="967" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="978" class="Symbol">=</a> <a id="980" href="Data.FreshList.InductiveInductive.html#551" class="Datatype">List#</a> <a id="986" href="Free.IdempotentCommutativeMonoid.Base.html#566" class="Bound Operator">_&lt;_</a>


<a id="992" class="Comment">-- The union or merge of two lists is defined using wellfounded</a>
<a id="1056" class="Comment">-- recursion on their total length; sometimes we decrease the length</a>
<a id="1125" class="Comment">-- of the first list, sometimes the second. We also simultaneously</a>
<a id="1192" class="Comment">-- prove that if a is fresh for two lists, then it is also fresh for</a>
<a id="1261" class="Comment">-- their union.</a>
<a id="union"></a><a id="1277" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1283" class="Symbol">:</a> <a id="1285" class="Symbol">(</a><a id="1286" href="Free.IdempotentCommutativeMonoid.Base.html#1286" class="Bound">xs</a> <a id="1289" href="Free.IdempotentCommutativeMonoid.Base.html#1289" class="Bound">ys</a> <a id="1292" class="Symbol">:</a> <a id="1294" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a><a id="1304" class="Symbol">)</a> <a id="1306" class="Symbol">→</a> <a id="1308" href="Induction.WellFounded.html#1182" class="Datatype">Acc</a> <a id="1312" href="Free.IdempotentCommutativeMonoid.Base.html#157" class="Function Operator">_&lt;ℕ_</a> <a id="1317" class="Symbol">(</a><a id="1318" href="Data.FreshList.InductiveInductive.html#4929" class="Function">length</a> <a id="1325" href="Free.IdempotentCommutativeMonoid.Base.html#1286" class="Bound">xs</a> <a id="1328" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1330" href="Data.FreshList.InductiveInductive.html#4929" class="Function">length</a> <a id="1337" href="Free.IdempotentCommutativeMonoid.Base.html#1289" class="Bound">ys</a><a id="1339" class="Symbol">)</a> <a id="1341" class="Symbol">→</a> <a id="1343" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a>
<a id="union-fresh"></a><a id="1354" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="1366" class="Symbol">:</a> <a id="1368" class="Symbol">{</a><a id="1369" href="Free.IdempotentCommutativeMonoid.Base.html#1369" class="Bound">a</a> <a id="1371" class="Symbol">:</a> <a id="1373" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a><a id="1374" class="Symbol">}</a> <a id="1376" class="Symbol">{</a><a id="1377" href="Free.IdempotentCommutativeMonoid.Base.html#1377" class="Bound">xs</a> <a id="1380" href="Free.IdempotentCommutativeMonoid.Base.html#1380" class="Bound">ys</a> <a id="1383" class="Symbol">:</a> <a id="1385" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a><a id="1395" class="Symbol">}</a> <a id="1397" class="Symbol">{</a><a id="1398" href="Free.IdempotentCommutativeMonoid.Base.html#1398" class="Bound">p</a> <a id="1400" class="Symbol">:</a> <a id="1402" href="Induction.WellFounded.html#1182" class="Datatype">Acc</a> <a id="1406" href="Free.IdempotentCommutativeMonoid.Base.html#157" class="Function Operator">_&lt;ℕ_</a> <a id="1411" class="Symbol">(</a><a id="1412" href="Data.FreshList.InductiveInductive.html#4929" class="Function">length</a> <a id="1419" href="Free.IdempotentCommutativeMonoid.Base.html#1377" class="Bound">xs</a> <a id="1422" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1424" href="Data.FreshList.InductiveInductive.html#4929" class="Function">length</a> <a id="1431" href="Free.IdempotentCommutativeMonoid.Base.html#1380" class="Bound">ys</a><a id="1433" class="Symbol">)}</a> <a id="1436" class="Symbol">→</a> <a id="1438" href="Free.IdempotentCommutativeMonoid.Base.html#1369" class="Bound">a</a> <a id="1440" href="Data.FreshList.InductiveInductive.html#614" class="Datatype Operator">#</a> <a id="1442" href="Free.IdempotentCommutativeMonoid.Base.html#1377" class="Bound">xs</a> <a id="1445" class="Symbol">→</a> <a id="1447" href="Free.IdempotentCommutativeMonoid.Base.html#1369" class="Bound">a</a> <a id="1449" href="Data.FreshList.InductiveInductive.html#614" class="Datatype Operator">#</a> <a id="1451" href="Free.IdempotentCommutativeMonoid.Base.html#1380" class="Bound">ys</a> <a id="1454" class="Symbol">→</a> <a id="1456" href="Free.IdempotentCommutativeMonoid.Base.html#1369" class="Bound">a</a> <a id="1458" href="Data.FreshList.InductiveInductive.html#614" class="Datatype Operator">#</a> <a id="1460" class="Symbol">(</a><a id="1461" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1467" href="Free.IdempotentCommutativeMonoid.Base.html#1377" class="Bound">xs</a> <a id="1470" href="Free.IdempotentCommutativeMonoid.Base.html#1380" class="Bound">ys</a> <a id="1473" href="Free.IdempotentCommutativeMonoid.Base.html#1398" class="Bound">p</a><a id="1474" class="Symbol">)</a>

<a id="1477" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1483" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a> <a id="1486" href="Free.IdempotentCommutativeMonoid.Base.html#1486" class="Bound">ys</a> <a id="1489" href="Free.IdempotentCommutativeMonoid.Base.html#1489" class="Bound">rs</a> <a id="1492" class="Symbol">=</a> <a id="1494" href="Free.IdempotentCommutativeMonoid.Base.html#1486" class="Bound">ys</a>
<a id="1497" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1503" class="Symbol">(</a><a id="1504" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1509" href="Free.IdempotentCommutativeMonoid.Base.html#1509" class="Bound">x</a> <a id="1511" href="Free.IdempotentCommutativeMonoid.Base.html#1511" class="Bound">xs</a> <a id="1514" href="Free.IdempotentCommutativeMonoid.Base.html#1514" class="Bound">x#xs</a><a id="1518" class="Symbol">)</a> <a id="1520" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a> <a id="1523" href="Free.IdempotentCommutativeMonoid.Base.html#1523" class="Bound">rs</a> <a id="1526" class="Symbol">=</a> <a id="1528" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1533" href="Free.IdempotentCommutativeMonoid.Base.html#1509" class="Bound">x</a> <a id="1535" href="Free.IdempotentCommutativeMonoid.Base.html#1511" class="Bound">xs</a> <a id="1538" href="Free.IdempotentCommutativeMonoid.Base.html#1514" class="Bound">x#xs</a>
<a id="1543" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1549" class="Symbol">(</a><a id="1550" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1555" href="Free.IdempotentCommutativeMonoid.Base.html#1555" class="Bound">x</a> <a id="1557" href="Free.IdempotentCommutativeMonoid.Base.html#1557" class="Bound">xs</a> <a id="1560" href="Free.IdempotentCommutativeMonoid.Base.html#1560" class="Bound">x#xs</a><a id="1564" class="Symbol">)</a> <a id="1566" class="Symbol">(</a><a id="1567" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1572" href="Free.IdempotentCommutativeMonoid.Base.html#1572" class="Bound">y</a> <a id="1574" href="Free.IdempotentCommutativeMonoid.Base.html#1574" class="Bound">ys</a> <a id="1577" href="Free.IdempotentCommutativeMonoid.Base.html#1577" class="Bound">y#ys</a><a id="1581" class="Symbol">)</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="1588" href="Free.IdempotentCommutativeMonoid.Base.html#1588" class="Bound">rs</a><a id="1590" class="Symbol">)</a> <a id="1592" class="Keyword">with</a> <a id="1597" href="Free.IdempotentCommutativeMonoid.Base.html#732" class="Function">&lt;-tri</a> <a id="1603" href="Free.IdempotentCommutativeMonoid.Base.html#1555" class="Bound">x</a> <a id="1605" href="Free.IdempotentCommutativeMonoid.Base.html#1572" class="Bound">y</a>
<a id="1607" class="Symbol">...</a> <a id="1611" class="Symbol">|</a> <a id="1613" href="Relation.Binary.Definitions.html#2857" class="InductiveConstructor">tri&lt;</a> <a id="1618" href="Free.IdempotentCommutativeMonoid.Base.html#1618" class="Bound">x&lt;y</a> <a id="1622" href="Free.IdempotentCommutativeMonoid.Base.html#1622" class="Bound">x≉y</a> <a id="1626" href="Free.IdempotentCommutativeMonoid.Base.html#1626" class="Bound">y≮x</a> <a id="1630" class="Symbol">=</a> <a id="1632" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1637" class="Bound">x</a> <a id="1639" class="Symbol">(</a><a id="1640" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1646" class="Bound">xs</a> <a id="1649" class="Symbol">(</a><a id="1650" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1655" class="Bound">y</a> <a id="1657" class="Bound">ys</a> <a id="1660" class="Bound">y#ys</a><a id="1664" class="Symbol">)</a> <a id="1666" class="Symbol">(</a><a id="1667" class="Bound">rs</a> <a id="1670" class="Symbol">_</a> <a id="1672" href="Data.Nat.Properties.html#4930" class="Function">≤-refl</a><a id="1678" class="Symbol">))</a> <a id="1681" class="Symbol">(</a><a id="1682" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="1694" class="Bound">x#xs</a> <a id="1699" class="Symbol">(</a><a id="1700" href="Free.IdempotentCommutativeMonoid.Base.html#1618" class="Bound">x&lt;y</a> <a id="1704" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="1706" class="Symbol">(</a><a id="1707" href="Data.FreshList.InductiveInductive.html#5019" class="Function">#-trans</a> <a id="1715" href="Free.IdempotentCommutativeMonoid.Base.html#779" class="Function">&lt;-trans</a> <a id="1723" class="Bound">x</a> <a id="1725" class="Bound">y</a> <a id="1727" class="Bound">ys</a> <a id="1730" href="Free.IdempotentCommutativeMonoid.Base.html#1618" class="Bound">x&lt;y</a> <a id="1734" class="Bound">y#ys</a><a id="1738" class="Symbol">)))</a>
<a id="1742" class="Symbol">...</a> <a id="1746" class="Symbol">|</a> <a id="1748" href="Relation.Binary.Definitions.html#2911" class="InductiveConstructor">tri≈</a> <a id="1753" href="Free.IdempotentCommutativeMonoid.Base.html#1753" class="Bound">x≮y</a> <a id="1757" href="Free.IdempotentCommutativeMonoid.Base.html#1757" class="Bound">x≈y</a> <a id="1761" href="Free.IdempotentCommutativeMonoid.Base.html#1761" class="Bound">y≮x</a> <a id="1765" class="Symbol">=</a> <a id="1767" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1772" class="Bound">x</a> <a id="1774" class="Symbol">(</a><a id="1775" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1781" class="Bound">xs</a> <a id="1784" class="Bound">ys</a> <a id="1787" class="Symbol">(</a><a id="1788" class="Bound">rs</a> <a id="1791" class="Symbol">_</a> <a id="1793" class="Symbol">(</a><a id="1794" href="Data.Nat.Base.html#1609" class="InductiveConstructor">s≤s</a> <a id="1798" class="Symbol">(</a><a id="1799" href="Data.Nat.Properties.html#5113" class="Function">≤-trans</a> <a id="1807" class="Symbol">(</a><a id="1808" href="Data.Nat.Properties.html#7721" class="Function">n≤1+n</a> <a id="1814" class="Symbol">_)</a> <a id="1817" class="Symbol">(</a><a id="1818" href="Data.Nat.Properties.html#4824" class="Function">≤-reflexive</a> <a id="1830" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="1832" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="1836" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="1838" href="Data.Nat.Properties.html#14247" class="Function">+-suc</a> <a id="1844" class="Symbol">_</a> <a id="1846" class="Symbol">_)))))</a> <a id="1853" class="Symbol">(</a><a id="1854" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="1866" class="Bound">x#xs</a> <a id="1871" class="Symbol">(</a><a id="1872" href="Data.FreshList.InductiveInductive.html#10929" class="Function">#-resp-≈</a> <a id="1881" class="Bound">y#ys</a> <a id="1886" class="Symbol">(</a><a id="1887" href="Free.IdempotentCommutativeMonoid.Base.html#699" class="Function">≈-sym</a> <a id="1893" href="Free.IdempotentCommutativeMonoid.Base.html#1757" class="Bound">x≈y</a><a id="1896" class="Symbol">)))</a>
<a id="1900" class="Symbol">...</a> <a id="1904" class="Symbol">|</a> <a id="1906" href="Relation.Binary.Definitions.html#2965" class="InductiveConstructor">tri&gt;</a> <a id="1911" href="Free.IdempotentCommutativeMonoid.Base.html#1911" class="Bound">x≮y</a> <a id="1915" href="Free.IdempotentCommutativeMonoid.Base.html#1915" class="Bound">x≉y</a> <a id="1919" href="Free.IdempotentCommutativeMonoid.Base.html#1919" class="Bound">y&lt;x</a> <a id="1923" class="Symbol">=</a> <a id="1925" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1930" class="Bound">y</a> <a id="1932" class="Symbol">(</a><a id="1933" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="1939" class="Symbol">(</a><a id="1940" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="1945" class="Bound">x</a> <a id="1947" class="Bound">xs</a> <a id="1950" class="Bound">x#xs</a><a id="1954" class="Symbol">)</a> <a id="1956" class="Bound">ys</a> <a id="1959" class="Symbol">(</a><a id="1960" class="Bound">rs</a> <a id="1963" class="Symbol">_</a> <a id="1965" class="Symbol">(</a><a id="1966" href="Data.Nat.Base.html#1609" class="InductiveConstructor">s≤s</a> <a id="1970" class="Symbol">(</a><a id="1971" href="Data.Nat.Properties.html#4824" class="Function">≤-reflexive</a> <a id="1983" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="1985" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="1989" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="1991" href="Data.Nat.Properties.html#14247" class="Function">+-suc</a> <a id="1997" class="Symbol">_</a> <a id="1999" class="Symbol">_))))</a> <a id="2005" class="Symbol">(</a><a id="2006" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2018" class="Symbol">(</a><a id="2019" href="Free.IdempotentCommutativeMonoid.Base.html#1919" class="Bound">y&lt;x</a> <a id="2023" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2025" href="Data.FreshList.InductiveInductive.html#5019" class="Function">#-trans</a> <a id="2033" href="Free.IdempotentCommutativeMonoid.Base.html#779" class="Function">&lt;-trans</a> <a id="2041" class="Bound">y</a> <a id="2043" class="Bound">x</a> <a id="2045" class="Bound">xs</a> <a id="2048" href="Free.IdempotentCommutativeMonoid.Base.html#1919" class="Bound">y&lt;x</a> <a id="2052" class="Bound">x#xs</a><a id="2056" class="Symbol">)</a> <a id="2058" class="Bound">y#ys</a><a id="2062" class="Symbol">)</a>

<a id="2065" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2077" class="Symbol">{</a><a id="2078" href="Free.IdempotentCommutativeMonoid.Base.html#2078" class="Bound">a</a><a id="2079" class="Symbol">}</a> <a id="2081" class="Symbol">{</a><a id="2082" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a><a id="2084" class="Symbol">}</a> <a id="2086" class="Symbol">{</a><a id="2087" href="Free.IdempotentCommutativeMonoid.Base.html#2087" class="Bound">ys</a><a id="2089" class="Symbol">}</a> <a id="2091" class="Symbol">{</a><a id="2092" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="2096" href="Free.IdempotentCommutativeMonoid.Base.html#2096" class="Bound">rs</a><a id="2098" class="Symbol">}</a> <a id="2100" href="Free.IdempotentCommutativeMonoid.Base.html#2100" class="Bound">a#xs</a> <a id="2105" href="Free.IdempotentCommutativeMonoid.Base.html#2105" class="Bound">a#ys</a> <a id="2110" class="Symbol">=</a> <a id="2112" href="Free.IdempotentCommutativeMonoid.Base.html#2105" class="Bound">a#ys</a>
<a id="2117" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2129" class="Symbol">{</a><a id="2130" href="Free.IdempotentCommutativeMonoid.Base.html#2130" class="Bound">a</a><a id="2131" class="Symbol">}</a> <a id="2133" class="Symbol">{</a><a id="2134" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="2139" href="Free.IdempotentCommutativeMonoid.Base.html#2139" class="Bound">x</a> <a id="2141" href="Free.IdempotentCommutativeMonoid.Base.html#2141" class="Bound">xs</a> <a id="2144" href="Free.IdempotentCommutativeMonoid.Base.html#2144" class="Bound">x#xs</a><a id="2148" class="Symbol">}</a> <a id="2150" class="Symbol">{</a><a id="2151" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a><a id="2153" class="Symbol">}</a> <a id="2155" class="Symbol">{</a><a id="2156" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="2160" href="Free.IdempotentCommutativeMonoid.Base.html#2160" class="Bound">rs</a><a id="2162" class="Symbol">}</a> <a id="2164" href="Free.IdempotentCommutativeMonoid.Base.html#2164" class="Bound">a#xs</a> <a id="2169" href="Free.IdempotentCommutativeMonoid.Base.html#2169" class="Bound">a#ys</a> <a id="2174" class="Symbol">=</a> <a id="2176" href="Free.IdempotentCommutativeMonoid.Base.html#2164" class="Bound">a#xs</a>
<a id="2181" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2193" class="Symbol">{</a><a id="2194" href="Free.IdempotentCommutativeMonoid.Base.html#2194" class="Bound">a</a><a id="2195" class="Symbol">}</a> <a id="2197" class="Symbol">{</a><a id="2198" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="2203" href="Free.IdempotentCommutativeMonoid.Base.html#2203" class="Bound">x</a> <a id="2205" href="Free.IdempotentCommutativeMonoid.Base.html#2205" class="Bound">xs</a> <a id="2208" href="Free.IdempotentCommutativeMonoid.Base.html#2208" class="Bound">x#xs</a><a id="2212" class="Symbol">}</a> <a id="2214" class="Symbol">{</a><a id="2215" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="2220" href="Free.IdempotentCommutativeMonoid.Base.html#2220" class="Bound">y</a> <a id="2222" href="Free.IdempotentCommutativeMonoid.Base.html#2222" class="Bound">ys</a> <a id="2225" href="Free.IdempotentCommutativeMonoid.Base.html#2225" class="Bound">y#ys</a><a id="2229" class="Symbol">}</a> <a id="2231" class="Symbol">{</a><a id="2232" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="2236" href="Free.IdempotentCommutativeMonoid.Base.html#2236" class="Bound">rs</a><a id="2238" class="Symbol">}</a> <a id="2240" class="Symbol">(</a><a id="2241" href="Free.IdempotentCommutativeMonoid.Base.html#2241" class="Bound">a&lt;x</a> <a id="2245" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2247" href="Free.IdempotentCommutativeMonoid.Base.html#2247" class="Bound">a#xs</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">(</a><a id="2254" href="Free.IdempotentCommutativeMonoid.Base.html#2254" class="Bound">a&lt;y</a> <a id="2258" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2260" href="Free.IdempotentCommutativeMonoid.Base.html#2260" class="Bound">a#ys</a><a id="2264" class="Symbol">)</a> <a id="2266" class="Keyword">with</a> <a id="2271" href="Free.IdempotentCommutativeMonoid.Base.html#732" class="Function">&lt;-tri</a> <a id="2277" href="Free.IdempotentCommutativeMonoid.Base.html#2203" class="Bound">x</a> <a id="2279" href="Free.IdempotentCommutativeMonoid.Base.html#2220" class="Bound">y</a>
<a id="2281" class="Symbol">...</a> <a id="2285" class="Symbol">|</a> <a id="2287" href="Relation.Binary.Definitions.html#2857" class="InductiveConstructor">tri&lt;</a> <a id="2292" href="Free.IdempotentCommutativeMonoid.Base.html#2292" class="Bound">x&lt;y</a> <a id="2296" href="Free.IdempotentCommutativeMonoid.Base.html#2296" class="Bound">x≉y</a> <a id="2300" href="Free.IdempotentCommutativeMonoid.Base.html#2300" class="Bound">y≮x</a> <a id="2304" class="Symbol">=</a> <a id="2306" class="Bound">a&lt;x</a> <a id="2310" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2312" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2324" class="Bound">a#xs</a> <a id="2329" class="Symbol">(</a><a id="2330" class="Bound">a&lt;y</a> <a id="2334" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2336" class="Bound">a#ys</a><a id="2340" class="Symbol">)</a>
<a id="2342" class="Symbol">...</a> <a id="2346" class="Symbol">|</a> <a id="2348" href="Relation.Binary.Definitions.html#2911" class="InductiveConstructor">tri≈</a> <a id="2353" href="Free.IdempotentCommutativeMonoid.Base.html#2353" class="Bound">x≮y</a> <a id="2357" href="Free.IdempotentCommutativeMonoid.Base.html#2357" class="Bound">x≈y</a> <a id="2361" href="Free.IdempotentCommutativeMonoid.Base.html#2361" class="Bound">y≮x</a> <a id="2365" class="Symbol">=</a> <a id="2367" class="Bound">a&lt;x</a> <a id="2371" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2373" class="Symbol">(</a><a id="2374" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2386" class="Bound">a#xs</a> <a id="2391" class="Bound">a#ys</a><a id="2395" class="Symbol">)</a>
<a id="2397" class="Symbol">...</a> <a id="2401" class="Symbol">|</a> <a id="2403" href="Relation.Binary.Definitions.html#2965" class="InductiveConstructor">tri&gt;</a> <a id="2408" href="Free.IdempotentCommutativeMonoid.Base.html#2408" class="Bound">x≮y</a> <a id="2412" href="Free.IdempotentCommutativeMonoid.Base.html#2412" class="Bound">x≉y</a> <a id="2416" href="Free.IdempotentCommutativeMonoid.Base.html#2416" class="Bound">y&lt;x</a> <a id="2420" class="Symbol">=</a> <a id="2422" class="Bound">a&lt;y</a> <a id="2426" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2428" href="Free.IdempotentCommutativeMonoid.Base.html#1354" class="Function">union-fresh</a> <a id="2440" class="Symbol">(</a><a id="2441" class="Bound">a&lt;x</a> <a id="2445" href="Data.FreshList.InductiveInductive.html#871" class="InductiveConstructor Operator">∷</a> <a id="2447" class="Bound">a#xs</a><a id="2451" class="Symbol">)</a> <a id="2453" class="Bound">a#ys</a>

<a id="2459" class="Comment">-- The top-level operation we really want</a>
<a id="_∪_"></a><a id="2501" href="Free.IdempotentCommutativeMonoid.Base.html#2501" class="Function Operator">_∪_</a> <a id="2505" class="Symbol">:</a> <a id="2507" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="2518" class="Symbol">→</a> <a id="2520" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="2531" class="Symbol">→</a> <a id="2533" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a>
<a id="2544" href="Free.IdempotentCommutativeMonoid.Base.html#2544" class="Bound">xs</a> <a id="2547" href="Free.IdempotentCommutativeMonoid.Base.html#2501" class="Function Operator">∪</a> <a id="2549" href="Free.IdempotentCommutativeMonoid.Base.html#2549" class="Bound">ys</a> <a id="2552" class="Symbol">=</a> <a id="2554" href="Free.IdempotentCommutativeMonoid.Base.html#1277" class="Function">union</a> <a id="2560" href="Free.IdempotentCommutativeMonoid.Base.html#2544" class="Bound">xs</a> <a id="2563" href="Free.IdempotentCommutativeMonoid.Base.html#2549" class="Bound">ys</a> <a id="2566" class="Symbol">(</a><a id="2567" href="Data.Nat.Induction.html#2196" class="Function">&lt;-wellFounded</a> <a id="2581" class="Symbol">(</a><a id="2582" href="Data.FreshList.InductiveInductive.html#4929" class="Function">length</a> <a id="2589" href="Free.IdempotentCommutativeMonoid.Base.html#2544" class="Bound">xs</a> <a id="2592" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2594" href="Data.FreshList.InductiveInductive.html#4929" class="Function">length</a> <a id="2601" href="Free.IdempotentCommutativeMonoid.Base.html#2549" class="Bound">ys</a><a id="2603" class="Symbol">))</a>

<a id="insert"></a><a id="2607" href="Free.IdempotentCommutativeMonoid.Base.html#2607" class="Function">insert</a> <a id="2614" class="Symbol">:</a> <a id="2616" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="2618" class="Symbol">→</a> <a id="2620" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="2631" class="Symbol">→</a> <a id="2633" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a>
<a id="2644" href="Free.IdempotentCommutativeMonoid.Base.html#2607" class="Function">insert</a> <a id="2651" href="Free.IdempotentCommutativeMonoid.Base.html#2651" class="Bound">x</a> <a id="2653" href="Free.IdempotentCommutativeMonoid.Base.html#2653" class="Bound">xs</a> <a id="2656" class="Symbol">=</a> <a id="2658" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="2663" href="Free.IdempotentCommutativeMonoid.Base.html#2651" class="Bound">x</a> <a id="2665" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a> <a id="2668" href="Data.FreshList.InductiveInductive.html#836" class="InductiveConstructor">[]</a> <a id="2671" href="Free.IdempotentCommutativeMonoid.Base.html#2501" class="Function Operator">∪</a> <a id="2673" href="Free.IdempotentCommutativeMonoid.Base.html#2653" class="Bound">xs</a>

<a id="_∩_"></a><a id="2677" href="Free.IdempotentCommutativeMonoid.Base.html#2677" class="Function Operator">_∩_</a> <a id="2681" class="Symbol">:</a> <a id="2683" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="2694" class="Symbol">-&gt;</a> <a id="2697" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a> <a id="2708" class="Symbol">-&gt;</a> <a id="2711" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a>
<a id="2722" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a> <a id="2725" href="Free.IdempotentCommutativeMonoid.Base.html#2677" class="Function Operator">∩</a> <a id="2727" href="Free.IdempotentCommutativeMonoid.Base.html#2727" class="Bound">ys</a> <a id="2730" class="Symbol">=</a> <a id="2732" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a>
<a id="2735" href="Free.IdempotentCommutativeMonoid.Base.html#2677" class="Function Operator">_∩_</a> <a id="2739" class="Symbol">(</a><a id="2740" href="Data.FreshList.InductiveInductive.html#746" class="InductiveConstructor">cons</a> <a id="2745" href="Free.IdempotentCommutativeMonoid.Base.html#2745" class="Bound">x</a> <a id="2747" href="Free.IdempotentCommutativeMonoid.Base.html#2747" class="Bound">xs</a> <a id="2750" href="Free.IdempotentCommutativeMonoid.Base.html#2750" class="Bound">p</a><a id="2751" class="Symbol">)</a> <a id="2753" href="Free.IdempotentCommutativeMonoid.Base.html#2753" class="Bound">ys</a> <a id="2756" class="Keyword">with</a> <a id="2761" href="Data.FreshList.InductiveInductive.html#2108" class="Function">any?</a> <a id="2766" class="Symbol">(</a><a id="2767" href="Free.IdempotentCommutativeMonoid.Base.html#2745" class="Bound">x</a> <a id="2769" href="Free.IdempotentCommutativeMonoid.Base.html#877" class="Function Operator">≈?_</a><a id="2772" class="Symbol">)</a> <a id="2774" href="Free.IdempotentCommutativeMonoid.Base.html#2753" class="Bound">ys</a>
<a id="2777" class="Symbol">...</a> <a id="2781" class="Symbol">|</a> <a id="2783" href="Relation.Nullary.Decidable.Core.html#1627" class="InductiveConstructor">yes</a> <a id="2787" class="Symbol">_</a> <a id="2789" class="Symbol">=</a> <a id="2791" href="Free.IdempotentCommutativeMonoid.Base.html#2607" class="Function">insert</a> <a id="2798" class="Bound">x</a> <a id="2800" class="Symbol">(</a><a id="2801" class="Bound">xs</a> <a id="2804" href="Free.IdempotentCommutativeMonoid.Base.html#2677" class="Function Operator">∩</a> <a id="2806" class="Bound">ys</a><a id="2808" class="Symbol">)</a>
<a id="2810" class="Symbol">...</a> <a id="2814" class="Symbol">|</a> <a id="2816" href="Relation.Nullary.Decidable.Core.html#1664" class="InductiveConstructor">no</a>  <a id="2820" class="Symbol">_</a> <a id="2822" class="Symbol">=</a> <a id="2824" class="Bound">xs</a> <a id="2827" href="Free.IdempotentCommutativeMonoid.Base.html#2677" class="Function Operator">∩</a> <a id="2829" class="Bound">ys</a>

<a id="insertion-sort"></a><a id="2833" href="Free.IdempotentCommutativeMonoid.Base.html#2833" class="Function">insertion-sort</a> <a id="2848" class="Symbol">:</a> <a id="2850" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2855" href="Free.IdempotentCommutativeMonoid.Base.html#536" class="Bound">X</a> <a id="2857" class="Symbol">→</a> <a id="2859" href="Free.IdempotentCommutativeMonoid.Base.html#950" class="Function">SortedList</a>
<a id="2870" href="Free.IdempotentCommutativeMonoid.Base.html#2833" class="Function">insertion-sort</a> <a id="2885" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2888" class="Symbol">=</a> <a id="2890" href="Data.FreshList.InductiveInductive.html#729" class="InductiveConstructor">[]</a>
<a id="2893" href="Free.IdempotentCommutativeMonoid.Base.html#2833" class="Function">insertion-sort</a> <a id="2908" class="Symbol">(</a><a id="2909" href="Free.IdempotentCommutativeMonoid.Base.html#2909" class="Bound">x</a> <a id="2911" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2913" href="Free.IdempotentCommutativeMonoid.Base.html#2913" class="Bound">xs</a><a id="2915" class="Symbol">)</a> <a id="2917" class="Symbol">=</a> <a id="2919" href="Free.IdempotentCommutativeMonoid.Base.html#2607" class="Function">insert</a> <a id="2926" href="Free.IdempotentCommutativeMonoid.Base.html#2909" class="Bound">x</a> <a id="2928" class="Symbol">(</a><a id="2929" href="Free.IdempotentCommutativeMonoid.Base.html#2833" class="Function">insertion-sort</a> <a id="2944" href="Free.IdempotentCommutativeMonoid.Base.html#2913" class="Bound">xs</a><a id="2946" class="Symbol">)</a>
</pre></body></html>